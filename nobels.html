<!DOCTYPE html>
<html lang="en">
    <head>
      <meta charset="UTF-8">
      <link rel="stylesheet" href="css/styles.css">
	  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/solid.css" integrity="sha384-uKQOWcYZKOuKmpYpvT0xCFAs/wE157X5Ua3H5onoRAOCNkJAMX/6QF0iXGGQV9cP" crossorigin="anonymous">
	  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/fontawesome.css" integrity="sha384-HU5rcgG/yUrsDGWsVACclYdzdCcn5yU8V/3V84zSrPDHwZEdjykadlgI6RHrxGrJ" crossorigin="anonymous">
      <title>Nobel Laureate Internet Database</title>
    </head>
  
    <body>
		
		<h1>Nobel Laureate Internet Database</h1>
		
		<h2>Please enter your search criteria below</h2>
		
		<form onsubmit="return false">
			<fieldset>
				<legend>Search Criteria</legend>
    			Start Year:<br>
    			<select id="startyear">
					<option value="1901" selected="selected">1901</option>
					<option value="1902">1902</option>
					<option value="1903">1903</option>
					<option value="1904">1904</option>
					<option value="1905">1905</option>
					<option value="1906">1906</option>
					<option value="1907">1907</option>
					<option value="1908">1908</option>
					<option value="1909">1909</option>
					<option value="1910">1910</option>
					<option value="1911">1911</option>
					<option value="1912">1912</option>
					<option value="1913">1913</option>
					<option value="1914">1914</option>
					<option value="1915">1915</option>
					<option value="1916">1916</option>
					<option value="1917">1917</option>
					<option value="1918">1918</option>
					<option value="1919">1919</option>
					<option value="1920">1920</option>
					<option value="1921">1921</option>
					<option value="1922">1922</option>
					<option value="1923">1923</option>
					<option value="1924">1924</option>
					<option value="1925">1925</option>
					<option value="1926">1926</option>
					<option value="1927">1927</option>
					<option value="1928">1928</option>
					<option value="1929">1929</option>
					<option value="1930">1930</option>
					<option value="1931">1931</option>
					<option value="1932">1932</option>
					<option value="1933">1933</option>
					<option value="1934">1934</option>
					<option value="1935">1935</option>
					<option value="1936">1936</option>
					<option value="1937">1937</option>
					<option value="1938">1938</option>
					<option value="1939">1939</option>
					<option value="1940">1940</option>
					<option value="1941">1941</option>
					<option value="1942">1942</option>
					<option value="1943">1943</option>
					<option value="1944">1944</option>
					<option value="1945">1945</option>
					<option value="1946">1946</option>
					<option value="1947">1947</option>
					<option value="1948">1948</option>
					<option value="1949">1949</option>
					<option value="1950">1950</option>
					<option value="1951">1951</option>
					<option value="1952">1952</option>
					<option value="1953">1953</option>
					<option value="1954">1954</option>
					<option value="1955">1955</option>
					<option value="1956">1956</option>
					<option value="1957">1957</option>
					<option value="1958">1958</option>
					<option value="1959">1959</option>
					<option value="1960">1960</option>
					<option value="1961">1961</option>
					<option value="1962">1962</option>
					<option value="1963">1963</option>
					<option value="1964">1964</option>
					<option value="1965">1965</option>
					<option value="1966">1966</option>
					<option value="1967">1967</option>
					<option value="1968">1968</option>
					<option value="1969">1969</option>
					<option value="1970">1970</option>
					<option value="1971">1971</option>
					<option value="1972">1972</option>
					<option value="1973">1973</option>
					<option value="1974">1974</option>
					<option value="1975">1975</option>
					<option value="1976">1976</option>
					<option value="1977">1977</option>
					<option value="1978">1978</option>
					<option value="1979">1979</option>
					<option value="1980">1980</option>
					<option value="1981">1981</option>
					<option value="1982">1982</option>
					<option value="1983">1983</option>
					<option value="1984">1984</option>
					<option value="1985">1985</option>
					<option value="1986">1986</option>
					<option value="1987">1987</option>
					<option value="1988">1988</option>
					<option value="1989">1989</option>
					<option value="1990">1990</option>
					<option value="1991">1991</option>
					<option value="1992">1992</option>
					<option value="1993">1993</option>
					<option value="1994">1994</option>
					<option value="1995">1995</option>
					<option value="1996">1996</option>
					<option value="1997">1997</option>
					<option value="1998">1998</option>
					<option value="1999">1999</option>
					<option value="2000">2000</option>
					<option value="2001">2001</option>
					<option value="2002">2002</option>
					<option value="2003">2003</option>
					<option value="2004">2004</option>
					<option value="2005">2005</option>
					<option value="2006">2006</option>
					<option value="2007">2007</option>
					<option value="2008">2008</option>
					<option value="2009">2009</option>
					<option value="2010">2010</option>
					<option value="2011">2011</option>
					<option value="2012">2012</option>
					<option value="2013">2013</option>
					<option value="2014">2014</option>
					<option value="2015">2015</option>
					<option value="2016">2016</option>
					<option value="2017">2017</option>
					<option value="2018">2018</option></select><br>
    			End Year:<br>
    			<select id="endyear">
					<option value="1901">1901</option>
					<option value="1902">1902</option>
					<option value="1903">1903</option>
					<option value="1904">1904</option>
					<option value="1905">1905</option>
					<option value="1906">1906</option>
					<option value="1907">1907</option>
					<option value="1908">1908</option>
					<option value="1909">1909</option>
					<option value="1910">1910</option>
					<option value="1911">1911</option>
					<option value="1912">1912</option>
					<option value="1913">1913</option>
					<option value="1914">1914</option>
					<option value="1915">1915</option>
					<option value="1916">1916</option>
					<option value="1917">1917</option>
					<option value="1918">1918</option>
					<option value="1919">1919</option>
					<option value="1920">1920</option>
					<option value="1921">1921</option>
					<option value="1922">1922</option>
					<option value="1923">1923</option>
					<option value="1924">1924</option>
					<option value="1925">1925</option>
					<option value="1926">1926</option>
					<option value="1927">1927</option>
					<option value="1928">1928</option>
					<option value="1929">1929</option>
					<option value="1930">1930</option>
					<option value="1931">1931</option>
					<option value="1932">1932</option>
					<option value="1933">1933</option>
					<option value="1934">1934</option>
					<option value="1935">1935</option>
					<option value="1936">1936</option>
					<option value="1937">1937</option>
					<option value="1938">1938</option>
					<option value="1939">1939</option>
					<option value="1940">1940</option>
					<option value="1941">1941</option>
					<option value="1942">1942</option>
					<option value="1943">1943</option>
					<option value="1944">1944</option>
					<option value="1945">1945</option>
					<option value="1946">1946</option>
					<option value="1947">1947</option>
					<option value="1948">1948</option>
					<option value="1949">1949</option>
					<option value="1950">1950</option>
					<option value="1951">1951</option>
					<option value="1952">1952</option>
					<option value="1953">1953</option>
					<option value="1954">1954</option>
					<option value="1955">1955</option>
					<option value="1956">1956</option>
					<option value="1957">1957</option>
					<option value="1958">1958</option>
					<option value="1959">1959</option>
					<option value="1960">1960</option>
					<option value="1961">1961</option>
					<option value="1962">1962</option>
					<option value="1963">1963</option>
					<option value="1964">1964</option>
					<option value="1965">1965</option>
					<option value="1966">1966</option>
					<option value="1967">1967</option>
					<option value="1968">1968</option>
					<option value="1969">1969</option>
					<option value="1970">1970</option>
					<option value="1971">1971</option>
					<option value="1972">1972</option>
					<option value="1973">1973</option>
					<option value="1974">1974</option>
					<option value="1975">1975</option>
					<option value="1976">1976</option>
					<option value="1977">1977</option>
					<option value="1978">1978</option>
					<option value="1979">1979</option>
					<option value="1980">1980</option>
					<option value="1981">1981</option>
					<option value="1982">1982</option>
					<option value="1983">1983</option>
					<option value="1984">1984</option>
					<option value="1985">1985</option>
					<option value="1986">1986</option>
					<option value="1987">1987</option>
					<option value="1988">1988</option>
					<option value="1989">1989</option>
					<option value="1990">1990</option>
					<option value="1991">1991</option>
					<option value="1992">1992</option>
					<option value="1993">1993</option>
					<option value="1994">1994</option>
					<option value="1995">1995</option>
					<option value="1996">1996</option>
					<option value="1997">1997</option>
					<option value="1998">1998</option>
					<option value="1999">1999</option>
					<option value="2000">2000</option>
					<option value="2001">2001</option>
					<option value="2002">2002</option>
					<option value="2003">2003</option>
					<option value="2004">2004</option>
					<option value="2005">2005</option>
					<option value="2006">2006</option>
					<option value="2007">2007</option>
					<option value="2008">2008</option>
					<option value="2009">2009</option>
					<option value="2010">2010</option>
					<option value="2011">2011</option>
					<option value="2012">2012</option>
					<option value="2013">2013</option>
					<option value="2014">2014</option>
					<option value="2015">2015</option>
					<option value="2016">2016</option>
					<option value="2017">2017</option>
					<option value="2018" selected="selected">2018</option></select><br>
				Categories:<br>
				<select id ="categories" name="categories">
					<option value="all">-</option>
					<option value="physics">Physics</option>
					<option value="chemistry">Chemistry</option>
					<option value="medicine">Medicine</option>
					<option value="peace">Peace</option>
					<option value="economics">Economics</option>
				</select><br>
				Country of Birth:<br>
				<select id ="countries" name="countries">
					<option value="all">-</option>
					<option value="DZ">Algeria</option>
					<option value="AR">Argentina</option>
					<option value="AU">Australia</option>
					<option value="AT">Austria</option>
					<option value="AZ">Azerbaijan</option>
					<option value="BD">Bangladesh</option>
					<option value="BY">Belarus</option>
					<option value="BE">Belgium</option>
					<option value="BA">Bosnia and Herzegovina</option>
					<option value="BR">Brazil</option>
					<option value="BG">Bulgaria</option>
					<option value="CA">Canada</option>
					<option value="CL">Chile</option>
					<option value="CN">China</option>
					<option value="CO">Colombia</option>
					<option value="CR">Costa Rica</option>
					<option value="HR">Croatia</option>
					<option value="CY">Cyprus</option>
					<option value="CZ">Czech Republic</option>
					<option value="DK">Denmark</option>
					<option value="TL">East Timor</option>
					<option value="EG">Egypt</option>
					<option value="FI">Finland</option>
					<option value="FR">France</option>
					<option value="DE">Germany</option>
					<option value="GH">Ghana</option>
					<option value="GR">Greece</option>
					<option value="GP">Guadeloupe Island</option>
					<option value="GT">Guatemala</option>
					<option value="HU">Hungary</option>
					<option value="IS">Iceland</option>
					<option value="IN">India</option>
					<option value="ID">Indonesia</option>
					<option value="IR">Iran</option>
					<option value="IE">Ireland</option>
					<option value="IL">Israel</option>
					<option value="IT">Italy</option>
					<option value="JP">Japan</option>
					<option value="KE">Kenya</option>
					<option value="LV">Latvia</option>
					<option value="LR">Liberia</option>
					<option value="LT">Lithuania</option>
					<option value="LU">Luxembourg</option>
					<option value="MK">Macedonia</option>
					<option value="MG">Madagascar</option>
					<option value="MX">Mexico</option>
					<option value="MA">Morocco</option>
					<option value="MM">Myanmar</option>
					<option value="NZ">New Zealand</option>
					<option value="NG">Nigeria</option>
					<option value="NO">Norway</option>
					<option value="PK">Pakistan</option>
					<option value="PE">Peru</option>
					<option value="PL">Poland</option>
					<option value="PT">Portugal</option>
					<option value="RO">Romania</option>
					<option value="RU">Russia</option>
					<option value="LC">Saint Lucia</option>
					<option value="SK">Slovakia</option>
					<option value="SI">Slovenia</option>
					<option value="ZA">South Africa</option>
					<option value="KR">South Korea</option>
					<option value="ES">Spain</option>
					<option value="SE">Sweden</option>
					<option value="CH">Switzerland</option>
					<option value="TW">Taiwan</option>
					<option value="NL">the Netherlands</option>
					<option value="TR">Turkey</option>
					<option value="UA">Ukraine</option>
					<option value="GB">United Kingdom</option>
					<option value="US">USA</option>
					<option value="VE">Venezuela</option>
					<option value="VN">Vietnam</option>
					<option value="YE">Yemen</option>
					<option value="ZW">Zimbabwe</option>
				</select><br>
    			<input type="submit" value="Submit" onclick="displayResults()">
			</fieldset>
  		</form>
		
		<div id="genderButtons">
			<form>
    			<fieldset>
        			<legend>Filter by Gender</legend>
					<div>
						<input type="radio" id="all" value="all" name="gender" onclick="showAllGenders()" checked />
						<label for="all">All</label>
					</div>

					<div>
						<input type="radio" id="male" value="male" name="gender" onclick="showMalesOnly()"/>
						<label for="male">Male</label>
					</div>

					<div>
						<input type="radio" id="female" value="female" name="gender" onclick="showFemalesOnly()"/>
						<label for="female">Female</label>
					</div>
					<div>
						<input type="radio" id="org" value="org" name="gender" onclick="showOrganizationsOnly()"/>
						<label for="org">Organizations</label>
					</div>
				</fieldset>
			</form>
		</div>
		
		<div id="laureatesTable"></div>
		
		<!--https://www.w3schools.com/howto/howto_css_modals.asp -->
		<div id="info-modal" class="modal"><div id="modal-content"></div></div>
      
        <footer> 
          <p>Made with <span aria-hidden="true">&hearts;</span> by Patrick Kennedy for UCD H.Dip Computer Science Web Application Development Assignment 2</p>
        </footer>
    
    <script>
    	var xmlhttp = new XMLHttpRequest();
        var url = "data.json";
        
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                //Parse the JSON data to a global JavaScript variable (global variable)
                parsedObj = JSON.parse(xmlhttp.responseText);
				startYearDropdown();
				endYearDropdown();
            }
        };

        xmlhttp.open("GET", url, true);
        xmlhttp.send();
        
        function getLaureatesData(obj, startYear, endYear, category, countryCode){
			
        	var laureatesArray = obj.laureates;
			var startYearInt = parseInt(startYear);
			var endYearInt = parseInt(endYear);
			
			// Laureates that match the requested search criteria (global variable)
			matches = [];
			
			// We need to filter our results by the search criteria
			for(var i = 0; i < laureatesArray.length; i++){
				for(var j = 0; j < laureatesArray[i].prizes.length; j++){
					var prizeYearInt = parseInt(laureatesArray[i].prizes[j].year);
					var prizeCategory = laureatesArray[i].prizes[j].category;
					var laureateCountryCodeOfBirth = laureatesArray[i].bornCountryCode;
					if (category == "all" && countryCode == 'all'){
						if (prizeYearInt >= startYearInt && prizeYearInt <= endYearInt) {
							matches.push(laureatesArray[i]);
							break
						}
					}
					else if (category == "all"){
						if (prizeYearInt >= startYearInt && prizeYearInt <= endYearInt && countryCode == laureateCountryCodeOfBirth) {
							matches.push(laureatesArray[i]);
							break
						}
					}
					else if (countryCode == "all"){
						if (prizeYearInt >= startYearInt && prizeYearInt <= endYearInt && category == prizeCategory) {
							matches.push(laureatesArray[i]);
							break
						} 
					}
					else if (prizeYearInt >= startYearInt && prizeYearInt <= endYearInt && category == prizeCategory && countryCode == laureateCountryCodeOfBirth) {
						matches.push(laureatesArray[i]);
						break
					}
				}
			}
									
			var laureatesInfo = "<table>";
			laureatesInfo += "<tr><th>Name</th><th>Category</th><th>Year of Award</th><th>Additional Info</th></tr>";
						
			for(var i = 0; i < matches.length; i++){
				for(var j = 0; j < matches[i].prizes.length; j++){
					laureatesInfo += "<tr class=\"" + matches[i].gender + "\">"
					laureatesInfo += "<td>" + matches[i].firstname + " ";
					if (matches[i].surname != null){
						laureatesInfo += matches[i].surname + "</td>";
					}
					laureatesInfo += "<td>" + matches[i].prizes[j].category + "</td>";
					laureatesInfo += "<td>" + matches[i].prizes[j].year + "</td>";
					laureatesInfo += "<td><button id=\"info_button\" onclick=\"additionalInfo(" + matches[i].id + ")\"><span class=\"fas fa-info-circle\"></span></button></td></tr>";
				}
    		}

    		laureatesInfo += "</table>"
    		document.getElementById("laureatesTable").innerHTML = laureatesInfo;
			
        }
		
		function displayResults(){
			// Form parameters that will get passed to getLaureatesData.
			var startyear = document.getElementById("startyear").value;
			var endyear = document.getElementById("endyear").value;
			var prizeCategory = document.getElementById("categories").value;
			var countryCodeOfBirth = document.getElementById("countries").value;
			
			// Fetch the results
			getLaureatesData(parsedObj, startyear, endyear, prizeCategory, countryCodeOfBirth);
			
			// Display the radio buttons
			document.getElementById("genderButtons").style.display = "block";
		
		}
		
		function showMalesOnly(){
			// Hide the female and org genders, display male
			var maleList = document.getElementsByClassName("male");
			var femaleList = document.getElementsByClassName("female");
			var orgList = document.getElementsByClassName("org");
						
			for (var i = 0; i < maleList.length; i++){
				maleList[i].style.display = "table-row";
			}
			
			for (i = 0; i < femaleList.length; i++){
				femaleList[i].style.display = "none";
			}
			
			for (i = 0; i < orgList.length; i++){
				orgList[i].style.display = "none";
			}
		}
		
		function showFemalesOnly(){
			// Hide the male and org genders, display female
			var maleList = document.getElementsByClassName("male");
			var femaleList = document.getElementsByClassName("female");
			var orgList = document.getElementsByClassName("org");
						
			for (var i = 0; i < maleList.length; i++){
				maleList[i].style.display = "none";
			}
			
			for (i = 0; i < femaleList.length; i++){
				femaleList[i].style.display = "table-row";
			}
			
			for (i = 0; i < orgList.length; i++){
				orgList[i].style.display = "none";
			}
		}
		
		function showOrganizationsOnly(){
			// Show organizations only
			var maleList = document.getElementsByClassName("male");
			var femaleList = document.getElementsByClassName("female");
			var orgList = document.getElementsByClassName("org");
						
			for (var i = 0; i < maleList.length; i++){
				maleList[i].style.display = "none";
			}
			
			for (i = 0; i < femaleList.length; i++){
				femaleList[i].style.display = "none";
			}
			
			for (i = 0; i < orgList.length; i++){
				orgList[i].style.display = "table-row";
			}
		}
		
		function showAllGenders(){
			// Show all genders
			var maleList = document.getElementsByClassName("male");
			var femaleList = document.getElementsByClassName("female");
			var orgList = document.getElementsByClassName("org");
						
			for (var i = 0; i < maleList.length; i++){
				maleList[i].style.display = "table-row";
			}
			
			for (i = 0; i < femaleList.length; i++){
				femaleList[i].style.display = "table-row";
			}
			
			for (i = 0; i < orgList.length; i++){
				orgList[i].style.display = "table-row";
			}
		}
		
		function additionalInfo(laureate_id){
			
			// Get the data to display
			additionalLaureateInfo = {}
			console.log(matches)
			for (var i = 0; i < matches.length; i++){
				if (matches[i].id == laureate_id){
					additionalLaureateInfo = matches[i]
				}
			}
			
			console.log(additionalLaureateInfo.born)
			console.log(additionalLaureateInfo.died)
			console.log(additionalLaureateInfo.bornCity)
			
			for (i = 0; i < additionalLaureateInfo.prizes.length; i++){
				console.log(additionalLaureateInfo.prizes[i].motivation);
			}
			
			// Display the modal
			var modal = document.getElementById('info-modal');
			modal.style.display = "block";

			// When the user clicks anywhere outside of the modal, close it
			window.onclick = function(event) {
				if (event.target == modal) {
					modal.style.display = "none";
				}
			}
			
			// Write the HTML
			var modalContent = "<span id=\"close\">&times;</span>";
			
			if (additionalLaureateInfo.born != "0000-00-00"){
				modalContent += "<p class=\"additional-info-heading\">Date of Birth</p>";
				modalContent += "<p>" + additionalLaureateInfo.born + "</p>";
			}
			
			if (additionalLaureateInfo.died != "0000-00-00"){
				modalContent += "<p class=\"additional-info-heading\">Date of Death</p>";
				modalContent += "<p>" + additionalLaureateInfo.died + "</p>";
			}
			
			if (additionalLaureateInfo.bornCity){
				modalContent += "<p class=\"additional-info-heading\">City of Birth</p>";
				modalContent += "<p>" + additionalLaureateInfo.bornCity + "</p>";
			}
			
			modalContent += "<p class=\"additional-info-heading\">Motivation</p>";
			modalContent += "<p>" + additionalLaureateInfo.prizes[0].motivation + "</p>";
			
			// Display the HTML in the inner modal
			document.getElementById("modal-content").innerHTML = modalContent;
			
			// When the user clicks on <span> (x), close the modal
			span = document.getElementById("close");
			
			span.onclick = function() {
				modal.style.display = "none";
			}
		}
		
		function startYearDropdown(){
			var html = "<option value=\"1901\" selected=\"selected\">1901</option>";
			for (var i = 1902; i <= 2018; i++){
				html += "<option value=\"" + i + "\">" + i + "</option>";
			}
			document.getElementById("startyear").innerHTML = html;
		}
		
		function endYearDropdown(){
			var html = "<option value=\"1901\">1901</option>";
			for (var i = 1902; i < 2018; i++){
				html += "<option value=\"" + i + "\">" + i + "</option>";
			}
			html += "<option value=\"2018\" selected=\"selected\">2018</option>";
			document.getElementById("endyear").innerHTML = html;
		} 
				
    </script>
      
    </body>
  
</html>